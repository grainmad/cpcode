
[华科大-04. 美丽字符串](https://leetcode.cn/contest/hust_1024_2023/problems/yH1vqC/)

2023.10.24活动

[「10·24」程序员节编程竞赛](https://leetcode.cn/contest/hust_1024_2023/)

设s下标从0开始。

我们分别求每个前缀的贡献。

对于`s[i] = '0'`的贡献，我们假设已经统计了前缀`s[0...i]`中的`'0'`的个数c0。

这时候，扩展串长度为2i+1，在排序后要保证串中心为`'0'`，那么至少需要i+1个`'0'`字符。我们已经有了c0个`'0'`字符。还需要**至少**i＋1-c0个字符。而在扩展串中我们可以操控的位置是i个，所以考虑i个位置中分别选i+1-c0个的情况，i+1-c0+1个的情况，等等，直到i个的情况。所以只需要计算组合数$C_{i}^{i+1-c0}+C_{i}^{i+1-c0+1}+\cdots+C_{i}^{i}$

转化一下得到$C_{i}^{c0-1}+C_{i}^{c0-2}+\cdots+C_{i}^{0}$。对于每一个前缀串，都需要计算这么一个组合数，直接遍历计算妥妥超时。必须$O(1)$计算出该值。

发现一个重大规律就是i和c0只增不减。
设$S_{i,j} = C_{i}^{0}+C_{i}^{1}+\cdots+C_{i}^{j}$

对于`s[0...i]`有j个`'0'`，已知$S_{i,j}$的情况下，`s[i+1]='1'`时，我们只需要求$S_{i+1,j+1}$，并将其加入答案中;`s[i+1]='0'`时，我们需要求$S_{i+1,j}$。

通过杨辉三角发现一个组合恒等式$C_{i}^{j}+C_{i}^{j+1} = C_{i+1}^{j+1}$


$2*S_{i,j} - C_{i}^{j} = S_{i+1, j}$

$2*S_{i,j} - C_{i}^{j} + C_{i+1, j+1} = S_{i+1, j+1}$

至此状态转移只需$O(1)$做到。总时间复杂度$O(n)$

对于`s[i]='1'`的情况，同理。